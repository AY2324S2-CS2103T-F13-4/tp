<p>Let’s walk you through the implementation of a new command — <code class="language-plaintext highlighter-rouge">remark</code>.</p>

<p>This command allows users of the AddressBook application to add optional remarks to people in their address book and edit it if required. The command should have the following format:</p>

<p><code class="language-plaintext highlighter-rouge">remark INDEX r/REMARK</code> (e.g., <code class="language-plaintext highlighter-rouge">remark 2 r/Likes baseball</code>)</p>

<p>We’ll assume that you have already set up the development environment as outlined in the Developer’s Guide.</p>

<h2 id="create-a-new-remark-command">Create a new <code class="language-plaintext highlighter-rouge">remark</code> command</h2>

<p>Looking in the <code class="language-plaintext highlighter-rouge">logic.command</code> package, you will notice that each existing command have their own class. All the commands inherit from the abstract class <code class="language-plaintext highlighter-rouge">Command</code> which means that they must override <code class="language-plaintext highlighter-rouge">execute()</code>. Each <code class="language-plaintext highlighter-rouge">Command</code> returns an instance of <code class="language-plaintext highlighter-rouge">CommandResult</code> upon success and <code class="language-plaintext highlighter-rouge">CommandResult#feedbackToUser</code> is printed to the <code class="language-plaintext highlighter-rouge">ResultDisplay</code>.</p>

<p>Let’s start by creating a new <code class="language-plaintext highlighter-rouge">RemarkCommand</code> class in the <code class="language-plaintext highlighter-rouge">src/main/java/seedu/address/logic/command</code> directory.</p>

<p>For now, let’s keep <code class="language-plaintext highlighter-rouge">RemarkCommand</code> as simple as possible and print some output. We accomplish that by returning a <code class="language-plaintext highlighter-rouge">CommandResult</code> with an accompanying message.</p>

<p><strong><code class="language-plaintext highlighter-rouge">RemarkCommand.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">seedu.address.logic.commands</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">seedu.address.model.Model</span><span class="o">;</span>

<span class="cm">/**
 * Changes the remark of an existing student in the address book.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RemarkCommand</span> <span class="kd">extends</span> <span class="nc">Command</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">COMMAND_WORD</span> <span class="o">=</span> <span class="s">"remark"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">CommandResult</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">CommandResult</span><span class="o">(</span><span class="s">"Hello from remark"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="hook-remarkcommand-into-the-application">Hook <code class="language-plaintext highlighter-rouge">RemarkCommand</code> into the application</h3>

<p>Now that we have our <code class="language-plaintext highlighter-rouge">RemarkCommand</code> ready to be executed, we need to update <code class="language-plaintext highlighter-rouge">AddressBookParser#parseCommand()</code> to recognize the <code class="language-plaintext highlighter-rouge">remark</code> keyword. Add the new command to the <code class="language-plaintext highlighter-rouge">switch</code> block by creating a new <code class="language-plaintext highlighter-rouge">case</code> that returns a new instance of <code class="language-plaintext highlighter-rouge">RemarkCommand</code>.</p>

<p>You can refer to the changes in this <a href="https://github.com/se-edu/addressbook-level3/commit/35eb7286f18a029d39cb7a29df8f172a001e4fd8#diff-399c284cb892c20b7c04a69116fcff6ccc0666c5230a1db8e4a9145def8fa4ee">diff</a>.</p>

<h3 id="run-the-application">Run the application</h3>

<p>Run <code class="language-plaintext highlighter-rouge">Main#main</code> and try out your new <code class="language-plaintext highlighter-rouge">RemarkCommand</code>. If everything went well, you should see something like this:</p>

<p><img src="../images/add-remark/RemarkHello.png" alt="Output displayed" /></p>

<h2 id="change-remarkcommand-to-throw-an-exception">Change <code class="language-plaintext highlighter-rouge">RemarkCommand</code> to throw an exception</h2>

<p>While we have successfully printed a message to <code class="language-plaintext highlighter-rouge">ResultDisplay</code>, the command does not do what it is supposed to do. Let’s change the command to throw a <code class="language-plaintext highlighter-rouge">CommandException</code> to accurately reflect that our command is still a work in progress.</p>

<p><img src="../images/add-remark/RemarkCommandClass.png" alt="The relationship between RemarkCommand and Command" /></p>

<p>Following the convention in other commands, we add relevant messages as constants and use them.</p>

<p><strong><code class="language-plaintext highlighter-rouge">RemarkCommand.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MESSAGE_USAGE</span> <span class="o">=</span> <span class="no">COMMAND_WORD</span>
            <span class="o">+</span> <span class="s">": Edits the remark of the student identified "</span>
            <span class="o">+</span> <span class="s">"by the index number used in the last student listing. "</span>
            <span class="o">+</span> <span class="s">"Existing remark will be overwritten by the input.\n"</span>
            <span class="o">+</span> <span class="s">"Parameters: INDEX (must be a positive integer) "</span>
            <span class="o">+</span> <span class="s">"r/ [REMARK]\n"</span>
            <span class="o">+</span> <span class="s">"Example: "</span> <span class="o">+</span> <span class="no">COMMAND_WORD</span> <span class="o">+</span> <span class="s">" 1 "</span>
            <span class="o">+</span> <span class="s">"r/ Likes to swim."</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MESSAGE_NOT_IMPLEMENTED_YET</span> <span class="o">=</span>
            <span class="s">"Remark command not implemented yet"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">CommandResult</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">CommandException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">CommandException</span><span class="o">(</span><span class="no">MESSAGE_NOT_IMPLEMENTED_YET</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<h2 id="enhancing-remarkcommand">Enhancing <code class="language-plaintext highlighter-rouge">RemarkCommand</code></h2>

<p>Let’s change <code class="language-plaintext highlighter-rouge">RemarkCommand</code> to parse input from the user.</p>

<h3 id="make-the-command-accept-parameters">Make the command accept parameters</h3>

<p>We start by modifying the constructor of <code class="language-plaintext highlighter-rouge">RemarkCommand</code> to accept an <code class="language-plaintext highlighter-rouge">Index</code> and a <code class="language-plaintext highlighter-rouge">String</code>. While we are at it, let’s change the error message to echo the values. While this is not a replacement for tests, it is an obvious way to tell if our code is functioning as intended.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">seedu</span><span class="o">.</span><span class="na">address</span><span class="o">.</span><span class="na">commons</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">CollectionUtil</span><span class="o">.</span><span class="na">requireAllNonNull</span><span class="o">;</span>
<span class="c1">//...</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RemarkCommand</span> <span class="kd">extends</span> <span class="nc">Command</span> <span class="o">{</span>
    <span class="c1">//...</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MESSAGE_ARGUMENTS</span> <span class="o">=</span> <span class="s">"Index: %1$d, Remark: %2$s"</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Index</span> <span class="n">index</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">remark</span><span class="o">;</span>

    <span class="cm">/**
     * @param index of the student in the filtered student list to edit the remark
     * @param remark of the student to be updated to
     */</span>
    <span class="kd">public</span> <span class="nf">RemarkCommand</span><span class="o">(</span><span class="nc">Index</span> <span class="n">index</span><span class="o">,</span> <span class="nc">String</span> <span class="n">remark</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">requireAllNonNull</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">remark</span><span class="o">);</span>

        <span class="k">this</span><span class="o">.</span><span class="na">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">remark</span> <span class="o">=</span> <span class="n">remark</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">CommandResult</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">CommandException</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">CommandException</span><span class="o">(</span>
                <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="no">MESSAGE_ARGUMENTS</span><span class="o">,</span> <span class="n">index</span><span class="o">.</span><span class="na">getOneBased</span><span class="o">(),</span> <span class="n">remark</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">equals</span><span class="o">(</span><span class="nc">Object</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">other</span> <span class="o">==</span> <span class="k">this</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// instanceof handles nulls</span>
        <span class="k">if</span> <span class="o">(!(</span><span class="n">other</span> <span class="k">instanceof</span> <span class="nc">RemarkCommand</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nc">RemarkCommand</span> <span class="n">e</span> <span class="o">=</span> <span class="o">(</span><span class="nc">RemarkCommand</span><span class="o">)</span> <span class="n">other</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">index</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">index</span><span class="o">)</span>
                <span class="o">&amp;&amp;</span> <span class="n">remark</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">remark</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Your code should look something like <a href="https://github.com/se-edu/addressbook-level3/commit/dc6d5139d08f6403da0ec624ea32bd79a2ae0cbf#diff-a8e35af8f9c251525063fae36c9852922a7e7195763018eacec60f3a4d87c594">this</a> after you are done.</p>

<h3 id="parse-user-input">Parse user input</h3>

<p>Now let’s move on to writing a parser that will extract the index and remark from the input provided by the user.</p>

<p>Create a <code class="language-plaintext highlighter-rouge">RemarkCommandParser</code> class in the <code class="language-plaintext highlighter-rouge">seedu.address.logic.parser</code> package. The class must extend the <code class="language-plaintext highlighter-rouge">Parser</code> interface.</p>

<p><img src="../images/add-remark/RemarkCommandParserClass.png" alt="The relationship between Parser and RemarkCommandParser" /></p>

<p>Thankfully, <code class="language-plaintext highlighter-rouge">ArgumentTokenizer#tokenize()</code> makes it trivial to parse user input. Let’s take a look at the JavaDoc provided for the function to understand what it does.</p>

<p><strong><code class="language-plaintext highlighter-rouge">ArgumentTokenizer.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Tokenizes an arguments string and returns an {@code ArgumentMultimap}
 * object that maps prefixes to their respective argument values. Only the
 * given prefixes will be recognized in the arguments string.
 *
 * @param argsString Arguments string of the form:
 * {@code preamble &lt;prefix&gt;value &lt;prefix&gt;value ...}
 * @param prefixes   Prefixes to tokenize the arguments string with
 * @return           ArgumentMultimap object that maps prefixes to their
 * arguments
 */</span>
</code></pre></div></div>

<p>We can tell <code class="language-plaintext highlighter-rouge">ArgumentTokenizer#tokenize()</code> to look out for our new prefix <code class="language-plaintext highlighter-rouge">r/</code> and it will return us an instance of <code class="language-plaintext highlighter-rouge">ArgumentMultimap</code>. Now let’s find out what we need to do in order to obtain the Index and String that we need. Let’s look through <code class="language-plaintext highlighter-rouge">ArgumentMultimap</code> :</p>

<p><strong><code class="language-plaintext highlighter-rouge">ArgumentMultimap.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Returns the last value of {@code prefix}.
 */</span>
<span class="kd">public</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getValue</span><span class="o">(</span><span class="nc">Prefix</span> <span class="n">prefix</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="n">getAllValues</span><span class="o">(</span><span class="n">prefix</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">?</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">empty</span><span class="o">()</span> <span class="o">:</span>
        <span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">values</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This appears to be what we need to get a String of the remark. But what about the Index? Let’s take a quick peek at existing <code class="language-plaintext highlighter-rouge">Command</code> that uses an index to see how it is done.</p>

<p><strong><code class="language-plaintext highlighter-rouge">DeleteCommandParser.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Index</span> <span class="n">index</span> <span class="o">=</span> <span class="nc">ParserUtil</span><span class="o">.</span><span class="na">parseIndex</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="k">return</span> <span class="k">new</span> <span class="nf">DeleteCommand</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
</code></pre></div></div>

<p>There appears to be another utility class that obtains an <code class="language-plaintext highlighter-rouge">Index</code> from the input provided by the user.</p>

<p>Now that we have the know-how to extract the data that we need from the user’s input, we can parse the user command and create a new instance of <code class="language-plaintext highlighter-rouge">RemarkCommand</code>, as given below.</p>

<p><strong><code class="language-plaintext highlighter-rouge">RemarkCommandParser.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">RemarkCommand</span> <span class="nf">parse</span><span class="o">(</span><span class="nc">String</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ParseException</span> <span class="o">{</span>
    <span class="n">requireNonNull</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
    <span class="nc">ArgumentMultimap</span> <span class="n">argMultimap</span> <span class="o">=</span> <span class="nc">ArgumentTokenizer</span><span class="o">.</span><span class="na">tokenize</span><span class="o">(</span><span class="n">args</span><span class="o">,</span>
        <span class="no">PREFIX_REMARK</span><span class="o">);</span>

    <span class="nc">Index</span> <span class="n">index</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nc">ParserUtil</span><span class="o">.</span><span class="na">parseIndex</span><span class="o">(</span><span class="n">argMultimap</span><span class="o">.</span><span class="na">getPreamble</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalValueException</span> <span class="n">ive</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ParseException</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="no">MESSAGE_INVALID_COMMAND_FORMAT</span><span class="o">,</span>
            <span class="nc">RemarkCommand</span><span class="o">.</span><span class="na">MESSAGE_USAGE</span><span class="o">),</span> <span class="n">ive</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nc">String</span> <span class="n">remark</span> <span class="o">=</span> <span class="n">argMultimap</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="no">PREFIX_REMARK</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nf">RemarkCommand</span><span class="o">(</span><span class="n">index</span><span class="o">,</span> <span class="n">remark</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="alert alert-primary">

:information_source: Don’t forget to update <code class="language-plaintext highlighter-rouge">AddressBookParser</code> to use our new <code class="language-plaintext highlighter-rouge">RemarkCommandParser</code>!

</div>

<p>If you are stuck, check out the sample
<a href="https://github.com/se-edu/addressbook-level3/commit/dc6d5139d08f6403da0ec624ea32bd79a2ae0cbf#diff-8bf239e8e9529369b577701303ddd96af93178b4ed6735f91c2d8488b20c6b4a">here</a>.</p>

<h2 id="add-remark-to-the-model">Add <code class="language-plaintext highlighter-rouge">Remark</code> to the model</h2>

<p>Now that we have all the information that we need, let’s lay the groundwork for propagating the remarks added into the in-memory storage of student data. We achieve that by working with the <code class="language-plaintext highlighter-rouge">Student</code> model. Each field in a Student is implemented as a separate class (e.g. a <code class="language-plaintext highlighter-rouge">Name</code> object represents the student’s name). That means we should add a <code class="language-plaintext highlighter-rouge">Remark</code> class so that we can use a <code class="language-plaintext highlighter-rouge">Remark</code> object to represent a remark given to a student.</p>

<h3 id="add-a-new-remark-class">Add a new <code class="language-plaintext highlighter-rouge">Remark</code> class</h3>

<p>Create a new <code class="language-plaintext highlighter-rouge">Remark</code> in <code class="language-plaintext highlighter-rouge">seedu.address.model.student</code>. Since a <code class="language-plaintext highlighter-rouge">Remark</code> is a field that is similar to <code class="language-plaintext highlighter-rouge">Address</code>, we can reuse a significant bit of code.</p>

<p>A copy-paste and search-replace later, you should have something like <a href="https://github.com/se-edu/addressbook-level3/commit/4516e099699baa9e2d51801bd26f016d812dedcc#diff-41bb13c581e280c686198251ad6cc337cd5e27032772f06ed9bf7f1440995ece">this</a>. Note how <code class="language-plaintext highlighter-rouge">Remark</code> has no constrains and thus does not require input
validation.</p>

<h3 id="make-use-of-remark">Make use of <code class="language-plaintext highlighter-rouge">Remark</code></h3>

<p>Let’s change <code class="language-plaintext highlighter-rouge">RemarkCommand</code> and <code class="language-plaintext highlighter-rouge">RemarkCommandParser</code> to use the new <code class="language-plaintext highlighter-rouge">Remark</code> class instead of plain <code class="language-plaintext highlighter-rouge">String</code>. These should be relatively simple changes.</p>

<h2 id="add-a-placeholder-element-for-remark-to-the-ui">Add a placeholder element for remark to the UI</h2>

<p>Without getting too deep into <code class="language-plaintext highlighter-rouge">fxml</code>, let’s go on a 5 minute adventure to get some placeholder text to show up for each student.</p>

<p>Simply add the following to <a href="https://github.com/se-edu/addressbook-level3/commit/850b78879582f38accb05dd20c245963c65ea599#diff-639834f1e05afe2276a86372adf0fe5f69314642c2d93cfa543d614ce5a76688"><code class="language-plaintext highlighter-rouge">seedu.address.ui.StudentCard</code></a>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">StudentCard.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FXML</span>
<span class="kd">private</span> <span class="nc">Label</span> <span class="n">remark</span><span class="o">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">@FXML</code> is an annotation that marks a private or protected field and makes it accessible to FXML. It might sound like Greek to you right now, don’t worry — we will get back to it later.</p>

<p>Then insert the following into <a href="https://github.com/se-edu/addressbook-level3/commit/850b78879582f38accb05dd20c245963c65ea599#diff-d44c4f51c24f6253c277a2bb9bc440b8064d9c15ad7cb7ceda280bca032efce9"><code class="language-plaintext highlighter-rouge">main/resources/view/StudentListCard.fxml</code></a>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">StudentListCard.fxml</code>:</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Label</span> <span class="na">fx:id=</span><span class="s">"remark"</span> <span class="na">styleClass=</span><span class="s">"cell_small_label"</span> <span class="na">text=</span><span class="s">"\$remark"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>That’s it! Fire up the application again and you should see something like this:</p>

<p><img src="../images/add-remark/$Remark.png" alt="$remark shows up in each entry" /></p>

<h2 id="modify-student-to-support-a-remark-field">Modify <code class="language-plaintext highlighter-rouge">Student</code> to support a <code class="language-plaintext highlighter-rouge">Remark</code> field</h2>

<p>Since <code class="language-plaintext highlighter-rouge">StudentCard</code> displays data from a <code class="language-plaintext highlighter-rouge">Student</code>, we need to update <code class="language-plaintext highlighter-rouge">Student</code> to get our <code class="language-plaintext highlighter-rouge">Remark</code> displayed!</p>

<h3 id="modify-student">Modify <code class="language-plaintext highlighter-rouge">Student</code></h3>

<p>We change the constructor of <code class="language-plaintext highlighter-rouge">Student</code> to take a <code class="language-plaintext highlighter-rouge">Remark</code>. We will also need to define new fields and accessors accordingly to store our new addition.</p>

<h3 id="update-other-usages-of-student">Update other usages of <code class="language-plaintext highlighter-rouge">Student</code></h3>

<p>Unfortunately, a change to <code class="language-plaintext highlighter-rouge">Student</code> will cause other commands to break, you will have to modify these commands to use the updated <code class="language-plaintext highlighter-rouge">Student</code>!</p>

<div class="alert alert-primary">

:bulb: Use the <code class="language-plaintext highlighter-rouge">Find Usages</code> feature in IntelliJ IDEA on the <code class="language-plaintext highlighter-rouge">Student</code> class to find these commands.

</div>

<p>Refer to <a href="https://github.com/se-edu/addressbook-level3/commit/ce998c37e65b92d35c91d28c7822cd139c2c0a5c">this commit</a> and check that you have got everything in order!</p>

<h2 id="updating-storage">Updating Storage</h2>

<p>AddressBook stores data by serializing <code class="language-plaintext highlighter-rouge">JsonAdaptedStudent</code> into <code class="language-plaintext highlighter-rouge">json</code> with the help of an external library — Jackson. Let’s update <code class="language-plaintext highlighter-rouge">JsonAdaptedStudent</code> to work with our new <code class="language-plaintext highlighter-rouge">Student</code>!</p>

<p>While the changes to code may be minimal, the test data will have to be updated as well.</p>

<div class="alert alert-warning">

:exclamation: You must delete AddressBook’s storage file located at <code class="language-plaintext highlighter-rouge">/data/addressbook.json</code> before running it! Not doing so will cause AddressBook to default to an empty address book!

</div>

<p>Check out <a href="https://github.com/se-edu/addressbook-level3/commit/556cbd0e03ff224d7a68afba171ad2eb0ce56bbf">this commit</a>
to see what the changes entail.</p>

<h2 id="finalizing-the-ui">Finalizing the UI</h2>

<p>Now that we have finalized the <code class="language-plaintext highlighter-rouge">Student</code> class and its dependencies, we can now bind the <code class="language-plaintext highlighter-rouge">Remark</code> field to the UI.</p>

<p>Just add <a href="https://github.com/se-edu/addressbook-level3/commit/5b98fee11b6b3f5749b6b943c4f3bd3aa049b692">this one line of code!</a></p>

<p><strong><code class="language-plaintext highlighter-rouge">StudentCard.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">StudentCard</span><span class="o">(</span><span class="nc">Student</span> <span class="n">student</span><span class="o">,</span> <span class="kt">int</span> <span class="n">displayedIndex</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//...</span>
    <span class="n">remark</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">student</span><span class="o">.</span><span class="na">getRemark</span><span class="o">().</span><span class="na">value</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><img src="../images/add-remark/RemarkBound.png" alt="The remark label is bound properly!" /></p>

<h2 id="putting-everything-together">Putting everything together</h2>

<p>After the previous step, we notice a peculiar regression — we went from displaying something to nothing at all. However, this is expected behavior as we are yet to update the <code class="language-plaintext highlighter-rouge">RemarkCommand</code> to make use of the code we’ve been adding in the last few steps.</p>

<h3 id="update-remarkcommand-and-remarkcommandparser">Update <code class="language-plaintext highlighter-rouge">RemarkCommand</code> and <code class="language-plaintext highlighter-rouge">RemarkCommandParser</code></h3>

<p>In this last step, we modify <code class="language-plaintext highlighter-rouge">RemarkCommand#execute()</code> to change the <code class="language-plaintext highlighter-rouge">Remark</code> of a <code class="language-plaintext highlighter-rouge">Student</code>. Since all fields in a <code class="language-plaintext highlighter-rouge">Student</code> are immutable, we create a new instance of a <code class="language-plaintext highlighter-rouge">Student</code> with the values that we want and
save it with <code class="language-plaintext highlighter-rouge">Model#setStudent()</code>.</p>

<p><strong><code class="language-plaintext highlighter-rouge">RemarkCommand.java</code>:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//...</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MESSAGE_ADD_REMARK_SUCCESS</span> <span class="o">=</span> <span class="s">"Added remark to Student: %1$s"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MESSAGE_DELETE_REMARK_SUCCESS</span> <span class="o">=</span> <span class="s">"Removed remark from Student: %1$s"</span><span class="o">;</span>
<span class="c1">//...</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">CommandResult</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">CommandException</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Student</span><span class="o">&gt;</span> <span class="n">lastShownList</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">getFilteredStudentList</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">index</span><span class="o">.</span><span class="na">getZeroBased</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="n">lastShownList</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">CommandException</span><span class="o">(</span><span class="nc">Messages</span><span class="o">.</span><span class="na">MESSAGE_INVALID_STUDENT_DISPLAYED_INDEX</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">Student</span> <span class="n">studentToEdit</span> <span class="o">=</span> <span class="n">lastShownList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">.</span><span class="na">getZeroBased</span><span class="o">());</span>
        <span class="nc">Student</span> <span class="n">editedStudent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Student</span><span class="o">(</span>
                <span class="n">studentToEdit</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">studentToEdit</span><span class="o">.</span><span class="na">getPhone</span><span class="o">(),</span> <span class="n">studentToEdit</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span>
                <span class="n">studentToEdit</span><span class="o">.</span><span class="na">getAddress</span><span class="o">(),</span> <span class="n">remark</span><span class="o">,</span> <span class="n">studentToEdit</span><span class="o">.</span><span class="na">getTags</span><span class="o">());</span>

        <span class="n">model</span><span class="o">.</span><span class="na">setStudent</span><span class="o">(</span><span class="n">studentToEdit</span><span class="o">,</span> <span class="n">editedStudent</span><span class="o">);</span>
        <span class="n">model</span><span class="o">.</span><span class="na">updateFilteredStudentList</span><span class="o">(</span><span class="no">PREDICATE_SHOW_ALL_STUDENTS</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">CommandResult</span><span class="o">(</span><span class="n">generateSuccessMessage</span><span class="o">(</span><span class="n">editedStudent</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Generates a command execution success message based on whether
     * the remark is added to or removed from
     * {@code studentToEdit}.
     */</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">generateSuccessMessage</span><span class="o">(</span><span class="nc">Student</span> <span class="n">studentToEdit</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="o">!</span><span class="n">remark</span><span class="o">.</span><span class="na">value</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span> <span class="o">?</span> <span class="no">MESSAGE_ADD_REMARK_SUCCESS</span> <span class="o">:</span> <span class="no">MESSAGE_DELETE_REMARK_SUCCESS</span><span class="o">;</span>
        <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">studentToEdit</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<p><img src="../images/add-remark/RemarkComplete.png" alt="Congratulations!" /></p>

<h2 id="writing-tests">Writing tests</h2>

<p>Tests are crucial to ensuring that bugs don’t slip into the codebase unnoticed. This is especially true for large code bases where a change might lead to unintended behavior.</p>

<p>Let’s verify the correctness of our code by writing some tests!</p>

<p>Of course you can simply add the test cases manually, like you’ve been doing all along this tutorial. The result would be like the test cases in <a href="https://github.com/se-edu/addressbook-level3/commit/fac8f3fd855d55831ca0cc73313b5943d49d4d6e#diff-ff58f7c10338b34f76645df49b71ecb2bafaf7611b20e7ff59ebc98475538a01">here</a>. Alternatively, you can get the help of IntelliJ to generate the skeletons of the test cases, as explained in the next section.</p>

<h3 id="automatically-generating-tests">Automatically generating tests</h3>

<p>The goal is to write effective and efficient tests to ensure that <code class="language-plaintext highlighter-rouge">RemarkCommand#execute()</code> behaves as expected.</p>

<p>The convention for test names is <code class="language-plaintext highlighter-rouge">methodName_testScenario_expectedResult</code>. An example would be
<code class="language-plaintext highlighter-rouge">execute_filteredList_success</code>.</p>

<p>Let’s create a test for <code class="language-plaintext highlighter-rouge">RemarkCommand#execute()</code> to test that adding a remark works. On <code class="language-plaintext highlighter-rouge">IntelliJ IDEA</code> you can bring up the context menu and choose to <code class="language-plaintext highlighter-rouge">Go To</code> &gt; <code class="language-plaintext highlighter-rouge">Test</code> or use the appropriate keyboard shortcut.</p>

<p><img src="../images/add-remark/ContextMenu.png" alt="Using the context menu to jump to tests" /></p>

<p>Then, create a test for the <code class="language-plaintext highlighter-rouge">execute</code> method.</p>

<p><img src="../images/add-remark/CreateTest.png" alt="Creating a test for `execute`." /></p>

<p>Following convention, let’s change the name of the generated method to <code class="language-plaintext highlighter-rouge">execute_addRemarkUnfilteredList_success</code>.</p>

<p>Let’s use the utility functions provided in <code class="language-plaintext highlighter-rouge">CommandTestUtil</code>. The functions ensure that commands produce the expected <code class="language-plaintext highlighter-rouge">CommandResult</code> and output the correct message. In this case, <code class="language-plaintext highlighter-rouge">CommandTestUtil#assertCommandSuccess</code> is the best fit as we are testing that a <code class="language-plaintext highlighter-rouge">RemarkCommand</code> will successfully add a <code class="language-plaintext highlighter-rouge">Remark</code>.</p>

<p>You should end up with a test that looks something like <a href="https://github.com/se-edu/addressbook-level3/commit/fac8f3fd855d55831ca0cc73313b5943d49d4d6e#diff-ff58f7c10338b34f76645df49b71ecb2bafaf7611b20e7ff59ebc98475538a01R36-R49">this</a>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>This concludes the tutorial for adding a new <code class="language-plaintext highlighter-rouge">Command</code> to AddressBook.</p>
